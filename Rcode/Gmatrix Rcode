#Downloads and unzips the G-matrix Data repository from GitHub
download.file("https://github.com/jprice96/G-matrix-Database/archive/master.zip", destfile="cov_matrices.zip")
unzip("cov_matrices.zip")

#Resets working directory from My Documents to downloaded Cov_matrices folder
setwd("G-matrix-Database-master/Cov_matrices")

#This creates a list of all of the files in the directory
matrix.files = dir(pattern="*csv")

#This is the number of files/matrices we have
num.of.files = length(matrix.files)

#This creates a blank list
all.matrices = list()

#This creates a list of matrix names minus the .csv
matrix.names = list()
for(i in 1:num.of.files){
  matrix.names[i] = gsub(".csv", "", matrix.files[i])
}

#This is a loop which goes through the files and extracts the matrices in matrix.list
for(i in 1:num.of.files){
  all.matrices[[i]] = read.csv(matrix.files[i])
}

#This names all of the matrices by their author, year and pop
names(all.matrices) = matrix.names

#Creates empty lists for value input
Pop.ID = numeric(num.of.files)
Gmax = numeric(num.of.files)

#Calculates and identifies parameters for all of the matrices
for (i in 1:num.of.files){
  Pop.ID[i] = matrix.names[[i]]
  tmp.matrix = all.matrices[[i]]
  tmp.values = eigen(tmp.matrix)
  Gmax[i] = tmp.values$values[1]
}

#Collates all the calculated parameters into a single data frame
summary.parameters = data.frame(Pop.ID, Gmax)
